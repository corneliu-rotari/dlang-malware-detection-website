import { Component } from '@angular/core';
import { NgForm } from '@angular/forms';
import { Router } from '@angular/router';
import { AuthService } from '../../../service/auth.service';

@Component({
  selector: 'app-signup',
  templateUrl: './signup.component.html',
  styleUrls: ['./signup.component.scss']
})
export class SignupComponent {
  message : string = "Internal error";
  finished : boolean = false;
  isError: boolean = false;

  constructor(private _auth : AuthService,private _router : Router) {}

  singup(form: NgForm) {
    this._auth.signup(form.value.username, form.value.email, form.value.password, form.value.desc, form.value.name).subscribe( {
      next : res => {
        console.log(res.body);
        this._router.navigate(["/auth/login"]);
        this.message = res.body;
      },
      error : er => {
        this.isError = true;
        if (er.error.statusMessage != null) {
          console.log(er.error.statusMessage);
          this.message =  er.error.statusMessage;
        } else {
          console.log("Error signup");
        }
      }
    }
  );
  form.reset();
  }
}
